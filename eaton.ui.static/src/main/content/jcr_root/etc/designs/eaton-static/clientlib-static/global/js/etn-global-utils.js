/**
 *
 *
 *
 * - THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY -
 * - Generated by Gulp (gulp-babel).
 *
 *
 *
 *
 */


//-----------------------------------
// Eaton: Utility Functions
//-----------------------------------
'use strict';

var App = App || {};
App.global = App.global || {};

App.global.utils = function () {

  // const isAEMTouchUI = (
  //   getCookie('cq-editor-layer.page') === 'Edit'
  //   && getCookie('cq-authoring-mode') === 'TOUCH'
  // )
  //   ? true
  //   : false;

  localStorage.setItem('backToSearch', 'false');

  var isAEMClassicUI = window.CQ && window.CQ.WCM && window.CQ.WCM.isEditMode() ? true : false;

  /*
  * Helper forEach
  * eg: App.global.utils.forEach( document.querySelectorAll('.cards'), (index, element) { ... } )
  * ----
  * NOTE: What you get back from querySelectorAll() isn't an array,
  * it's a (non-live) NodeList, and not all browsers support the method .forEach on NodeList's
  */
  function forEach(array, callback, scope) {
    for (var i = 0; i < array.length; i++) {
      callback.call(scope, i, array[i]);
    }
  }

  /**
  * Get Cookie Value
  * @param { String } cookieName
  */
  function getCookie(cookieName) {
    var match = document.cookie.match(new RegExp('(^| )' + cookieName + '=([^;]+)'));

    if (match) {
      return match[2];
    }
  }

  /**
  * AEM's Author mode
  */
  function isAEMAuthorMode() {
    return isAEMClassicUI ? true : false;
  }

  /**
   * Extract i18n Strings from the HTML attribute "data-i18n" for the give Element.
   * eg: <div data-i18n="{ "close": "Close Overlay" }">
   * @param { DOMElement }
   * @return { Object }
   */
  var loadI18NStrings = function loadI18NStrings(element) {
    var i18nData = element[0].dataset.i18n;

    // Save i18n Strings as an Object in a global variable
    return JSON.parse(i18nData) ? JSON.parse(i18nData) : {};
  };

  /**
  * Helper: Throttle Functions
  */
  function throttle(fn, threshhold, scope) {
    threshhold = threshhold || 250;
    var last = void 0;
    var deferTimer = void 0;

    return function () {
      var context = scope || this;
      var now = +new Date();
      var args = arguments;

      if (last && now < last + threshhold) {
        // hold on to it
        clearTimeout(deferTimer);
        deferTimer = setTimeout(function () {
          last = now;
          fn.apply(context, args);
        }, threshhold);
      } else {
        last = now;
        fn.apply(context, args);
      }
    };
  }

  // Public Methods
  return {
    forEach: forEach,
    getCookie: getCookie,
    isAEMAuthorMode: isAEMAuthorMode,
    loadI18NStrings: loadI18NStrings,
    throttle: throttle
  };
}();